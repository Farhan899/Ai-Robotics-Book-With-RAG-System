"use strict";(globalThis.webpackChunkmy_website=globalThis.webpackChunkmy_website||[]).push([[283],{3233(e,n,i){i.r(n),i.d(n,{assets:()=>o,contentTitle:()=>t,default:()=>u,frontMatter:()=>a,metadata:()=>s,toc:()=>c});const s=JSON.parse('{"id":"module-1-ros2/hands-on","title":"Hands-On: ROS 2 Nodes, Topics, Services, and Actions","description":"Exercise 1: Creating Your First ROS 2 Node","source":"@site/docs/module-1-ros2/hands-on.md","sourceDirName":"module-1-ros2","slug":"/module-1-ros2/hands-on","permalink":"/docs/module-1-ros2/hands-on","draft":false,"unlisted":false,"editUrl":"https://github.com/Farhan899/Ai-Robotics-Book/edit/main/docs/module-1-ros2/hands-on.md","tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"ROS 2 Architecture and DDS Middleware","permalink":"/docs/module-1-ros2/architecture"},"next":{"title":"Code Examples: ROS 2 with rclpy and URDF","permalink":"/docs/module-1-ros2/code-examples"}}');var r=i(4848),l=i(8453);const a={},t="Hands-On: ROS 2 Nodes, Topics, Services, and Actions",o={},c=[{value:"Exercise 1: Creating Your First ROS 2 Node",id:"exercise-1-creating-your-first-ros-2-node",level:2},{value:"Prerequisites",id:"prerequisites",level:3},{value:"Steps",id:"steps",level:3},{value:"Exercise 2: Creating a Subscriber Node",id:"exercise-2-creating-a-subscriber-node",level:2},{value:"Exercise 3: Creating a Service Server and Client",id:"exercise-3-creating-a-service-server-and-client",level:2},{value:"Service Server",id:"service-server",level:3},{value:"Service Client",id:"service-client",level:3},{value:"Exercise 4: Creating a Simple URDF",id:"exercise-4-creating-a-simple-urdf",level:2},{value:"Exercise 5: Visualizing the Robot in RViz",id:"exercise-5-visualizing-the-robot-in-rviz",level:2},{value:"Key Takeaways",id:"key-takeaways",level:2},{value:"Key Concepts",id:"key-concepts",level:2},{value:"Common Failure Modes",id:"common-failure-modes",level:2}];function d(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,l.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"hands-on-ros-2-nodes-topics-services-and-actions",children:"Hands-On: ROS 2 Nodes, Topics, Services, and Actions"})}),"\n",(0,r.jsx)(n.h2,{id:"exercise-1-creating-your-first-ros-2-node",children:"Exercise 1: Creating Your First ROS 2 Node"}),"\n",(0,r.jsx)(n.p,{children:"In this exercise, you'll create a simple ROS 2 node that publishes messages to a topic."}),"\n",(0,r.jsx)(n.h3,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"ROS 2 Humble installed"}),"\n",(0,r.jsx)(n.li,{children:"Basic Python knowledge"}),"\n",(0,r.jsx)(n.li,{children:"Terminal access"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"steps",children:"Steps"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Create a new Python package for your ROS 2 nodes:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"mkdir -p ~/ros2_ws/src/my_robot_nodes\ncd ~/ros2_ws/src/my_robot_nodes\n"})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Create a ",(0,r.jsx)(n.code,{children:"setup.py"})," file:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"from setuptools import setup\n\npackage_name = 'my_robot_nodes'\n\nsetup(\n    name=package_name,\n    version='0.0.0',\n    packages=[],\n    py_modules=[],\n    install_requires=['setuptools'],\n    zip_safe=True,\n    maintainer='Your Name',\n    maintainer_email='your.email@example.com',\n    description='Simple ROS 2 nodes for learning',\n    license='Apache License 2.0',\n)\n"})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Create a ",(0,r.jsx)(n.code,{children:"publisher_node.py"})," file:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"import rclpy\nfrom rclpy.node import Node\nfrom std_msgs.msg import String\n\n\nclass MinimalPublisher(Node):\n\n    def __init__(self):\n        super().__init__('minimal_publisher')\n        self.publisher_ = self.create_publisher(String, 'topic', 10)\n        timer_period = 0.5  # seconds\n        self.timer = self.create_timer(timer_period, self.timer_callback)\n        self.i = 0\n\n    def timer_callback(self):\n        msg = String()\n        msg.data = 'Hello World: %d' % self.i\n        self.publisher_.publish(msg)\n        self.get_logger().info('Publishing: \"%s\"' % msg.data)\n        self.i += 1\n\n\ndef main(args=None):\n    rclpy.init(args=args)\n\n    minimal_publisher = MinimalPublisher()\n\n    rclpy.spin(minimal_publisher)\n\n    # Destroy the node explicitly\n    minimal_publisher.destroy_node()\n    rclpy.shutdown()\n\n\nif __name__ == '__main__':\n    main()\n"})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Make the file executable:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"chmod +x publisher_node.py\n"})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Source your ROS 2 installation and run the publisher:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"source /opt/ros/humble/setup.bash\ncd ~/ros2_ws/src/my_robot_nodes\npython3 publisher_node.py\n"})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"In a new terminal, listen to the topic:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"source /opt/ros/humble/setup.bash\nros2 topic echo /topic std_msgs/msg/String\n"})}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"exercise-2-creating-a-subscriber-node",children:"Exercise 2: Creating a Subscriber Node"}),"\n",(0,r.jsx)(n.p,{children:"Now create a subscriber node that receives messages from the publisher."}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Create a ",(0,r.jsx)(n.code,{children:"subscriber_node.py"})," file:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"import rclpy\nfrom rclpy.node import Node\nfrom std_msgs.msg import String\n\n\nclass MinimalSubscriber(Node):\n\n    def __init__(self):\n        super().__init__('minimal_subscriber')\n        self.subscription = self.create_subscription(\n            String,\n            'topic',\n            self.listener_callback,\n            10)\n        self.subscription  # prevent unused variable warning\n\n    def listener_callback(self, msg):\n        self.get_logger().info('I heard: \"%s\"' % msg.data)\n\n\ndef main(args=None):\n    rclpy.init(args=args)\n\n    minimal_subscriber = MinimalSubscriber()\n\n    rclpy.spin(minimal_subscriber)\n\n    # Destroy the node explicitly\n    minimal_subscriber.destroy_node()\n    rclpy.shutdown()\n\n\nif __name__ == '__main__':\n    main()\n"})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Make the file executable and run it:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"chmod +x subscriber_node.py\nsource /opt/ros/humble/setup.bash\npython3 subscriber_node.py\n"})}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"exercise-3-creating-a-service-server-and-client",children:"Exercise 3: Creating a Service Server and Client"}),"\n",(0,r.jsx)(n.p,{children:"Create a simple service that adds two integers."}),"\n",(0,r.jsx)(n.h3,{id:"service-server",children:"Service Server"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["Create ",(0,r.jsx)(n.code,{children:"service_server.py"}),":","\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"import rclpy\nfrom rclpy.node import Node\nfrom example_interfaces.srv import AddTwoInts\n\n\nclass MinimalService(Node):\n\n    def __init__(self):\n        super().__init__('minimal_service')\n        self.srv = self.create_service(AddTwoInts, 'add_two_ints', self.add_two_ints_callback)\n\n    def add_two_ints_callback(self, request, response):\n        response.sum = request.a + request.b\n        self.get_logger().info('Incoming request\\na: %d b: %d' % (request.a, request.b))\n        return response\n\n\ndef main(args=None):\n    rclpy.init(args=args)\n\n    minimal_service = MinimalService()\n\n    rclpy.spin(minimal_service)\n\n    rclpy.shutdown()\n\n\nif __name__ == '__main__':\n    main()\n"})}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"service-client",children:"Service Client"}),"\n",(0,r.jsxs)(n.ol,{start:"2",children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Create ",(0,r.jsx)(n.code,{children:"service_client.py"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"import sys\nimport rclpy\nfrom rclpy.node import Node\nfrom example_interfaces.srv import AddTwoInts\n\n\nclass MinimalClient(Node):\n\n    def __init__(self):\n        super().__init__('minimal_client')\n        self.cli = self.create_client(AddTwoInts, 'add_two_ints')\n        while not self.cli.wait_for_service(timeout_sec=1.0):\n            self.get_logger().info('service not available, waiting again...')\n        self.req = AddTwoInts.Request()\n\n    def send_request(self, a, b):\n        self.req.a = a\n        self.req.b = b\n        future = self.cli.call_async(self.req)\n        rclpy.spin_until_future_complete(self, future)\n        return future.result()\n\n\ndef main(args=None):\n    rclpy.init(args=args)\n\n    minimal_client = MinimalClient()\n    response = minimal_client.send_request(int(sys.argv[1]), int(sys.argv[2]))\n    minimal_client.get_logger().info(\n        'Result of add_two_ints: for %d + %d = %d' %\n        (int(sys.argv[1]), int(sys.argv[2]), response.sum))\n\n    minimal_client.destroy_node()\n    rclpy.shutdown()\n\n\nif __name__ == '__main__':\n    main()\n"})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Run the service server in one terminal:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"chmod +x service_server.py\nsource /opt/ros/humble/setup.bash\npython3 service_server.py\n"})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"In another terminal, call the service:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"chmod +x service_client.py\nsource /opt/ros/humble/setup.bash\npython3 service_client.py 2 3\n"})}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"exercise-4-creating-a-simple-urdf",children:"Exercise 4: Creating a Simple URDF"}),"\n",(0,r.jsx)(n.p,{children:"Create a minimal humanoid URDF file."}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Create a ",(0,r.jsx)(n.code,{children:"urdf"})," directory in your package:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"mkdir urdf\n"})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Create ",(0,r.jsx)(n.code,{children:"simple_humanoid.urdf"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-xml",children:'<?xml version="1.0"?>\n<robot name="simple_humanoid">\n  \x3c!-- Base link --\x3e\n  <link name="base_link">\n    <visual>\n      <geometry>\n        <box size="0.5 0.2 0.2"/>\n      </geometry>\n      <material name="blue">\n        <color rgba="0 0 1 1"/>\n      </material>\n    </visual>\n    <collision>\n      <geometry>\n        <box size="0.5 0.2 0.2"/>\n      </geometry>\n    </collision>\n    <inertial>\n      <mass value="1.0"/>\n      <inertia ixx="1.0" ixy="0.0" ixz="0.0" iyy="1.0" iyz="0.0" izz="1.0"/>\n    </inertial>\n  </link>\n\n  \x3c!-- Head --\x3e\n  <link name="head">\n    <visual>\n      <geometry>\n        <sphere radius="0.1"/>\n      </geometry>\n      <material name="white">\n        <color rgba="1 1 1 1"/>\n      </material>\n    </visual>\n    <collision>\n      <geometry>\n        <sphere radius="0.1"/>\n      </geometry>\n    </collision>\n    <inertial>\n      <mass value="0.5"/>\n      <inertia ixx="0.01" ixy="0.0" ixz="0.0" iyy="0.01" iyz="0.0" izz="0.01"/>\n    </inertial>\n  </link>\n\n  <joint name="neck_joint" type="fixed">\n    <parent link="base_link"/>\n    <child link="head"/>\n    <origin xyz="0.3 0 0"/>\n  </joint>\n\n  \x3c!-- Left Arm --\x3e\n  <link name="left_upper_arm">\n    <visual>\n      <geometry>\n        <cylinder length="0.3" radius="0.05"/>\n      </geometry>\n      <material name="red">\n        <color rgba="1 0 0 1"/>\n      </material>\n    </visual>\n    <collision>\n      <geometry>\n        <cylinder length="0.3" radius="0.05"/>\n      </geometry>\n    </collision>\n    <inertial>\n      <mass value="0.3"/>\n      <inertia ixx="0.01" ixy="0.0" ixz="0.0" iyy="0.01" iyz="0.0" izz="0.01"/>\n    </inertial>\n  </link>\n\n  <joint name="left_shoulder_joint" type="revolute">\n    <parent link="base_link"/>\n    <child link="left_upper_arm"/>\n    <origin xyz="0.1 0.15 0" rpy="0 0 0"/>\n    <axis xyz="0 0 1"/>\n    <limit lower="-1.57" upper="1.57" effort="100" velocity="1"/>\n  </joint>\n</robot>\n'})}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"exercise-5-visualizing-the-robot-in-rviz",children:"Exercise 5: Visualizing the Robot in RViz"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Create a launch file ",(0,r.jsx)(n.code,{children:"display.launch.py"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"import os\nfrom ament_index_python.packages import get_package_share_directory\nfrom launch import LaunchDescription\nfrom launch.actions import DeclareLaunchArgument\nfrom launch.substitutions import LaunchConfiguration\nfrom launch_ros.actions import Node\n\n\ndef generate_launch_description():\n    # Find the URDF file\n    urdf_file = os.path.join(\n        get_package_share_directory('my_robot_nodes'),\n        'urdf',\n        'simple_humanoid.urdf'\n    )\n\n    # Read the URDF file\n    with open(urdf_file, 'r') as infp:\n        robot_desc = infp.read()\n\n    # Launch configuration\n    use_sim_time = LaunchConfiguration('use_sim_time', default='false')\n\n    # Declare launch arguments\n    declare_use_sim_time_argument = DeclareLaunchArgument(\n        'use_sim_time',\n        default_value='false',\n        description='Use simulation/Gazebo clock')\n\n    # Robot state publisher node\n    params = {'use_sim_time': use_sim_time, 'robot_description': robot_desc}\n    start_robot_state_publisher_cmd = Node(\n        package='robot_state_publisher',\n        executable='robot_state_publisher',\n        name='robot_state_publisher',\n        output='screen',\n        parameters=[params]\n    )\n\n    # Joint state publisher GUI node\n    joint_state_publisher_gui_node = Node(\n        package='joint_state_publisher_gui',\n        executable='joint_state_publisher_gui',\n        name='joint_state_publisher_gui',\n        output='screen'\n    )\n\n    # RViz node\n    rviz_node = Node(\n        package='rviz2',\n        executable='rviz2',\n        name='rviz2',\n        output='screen'\n    )\n\n    # Create launch description and add actions\n    ld = LaunchDescription()\n\n    ld.add_action(declare_use_sim_time_argument)\n    ld.add_action(start_robot_state_publisher_cmd)\n    ld.add_action(joint_state_publisher_gui_node)\n    ld.add_action(rviz_node)\n\n    return ld\n"})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Launch the visualization:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"source /opt/ros/humble/setup.bash\nros2 launch display.launch.py\n"})}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"key-takeaways",children:"Key Takeaways"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Nodes are the basic execution units in ROS 2"}),"\n",(0,r.jsx)(n.li,{children:"Topics enable asynchronous publish-subscribe communication"}),"\n",(0,r.jsx)(n.li,{children:"Services provide synchronous request-response communication"}),"\n",(0,r.jsx)(n.li,{children:"Actions are for long-running tasks with feedback"}),"\n",(0,r.jsx)(n.li,{children:"URDF describes robot kinematics, dynamics, and visual properties"}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"key-concepts",children:"Key Concepts"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Node"}),": A process that performs computation"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Topic"}),": Named bus for message exchange"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Service"}),": Synchronous request/response communication"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Action"}),": Asynchronous goal-based communication with feedback"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"URDF"}),": Unified Robot Description Format for robot modeling"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"RViz"}),": 3D visualization tool for ROS"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"common-failure-modes",children:"Common Failure Modes"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Node Communication Issues"}),": Nodes may not communicate if topics/services have different names or incompatible message types"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Parameter Configuration"}),": Incorrect QoS settings can prevent communication"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"URDF Parsing Errors"}),": Syntax errors in URDF files can prevent robot visualization"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Launch File Issues"}),": Missing dependencies or incorrect paths in launch files can cause failures"]}),"\n"]})]})}function u(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},8453(e,n,i){i.d(n,{R:()=>a,x:()=>t});var s=i(6540);const r={},l=s.createContext(r);function a(e){const n=s.useContext(l);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function t(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:a(e.components),s.createElement(l.Provider,{value:n},e.children)}}}]);